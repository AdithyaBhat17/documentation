(window.webpackJsonp=window.webpackJsonp||[]).push([[285],{362:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return u})),n.d(t,"default",(function(){return d}));var a=n(3),r=n(7),c=(n(0),n(411)),o=n(415),i=n(416),s={title:"nats_stream",type:"input",status:"stable",categories:["Services"]},l={unversionedId:"components/inputs/nats_stream",id:"components/inputs/nats_stream",isDocsHomePage:!1,title:"nats_stream",description:"\x3c!--",source:"@site/docs/components/inputs/nats_stream.md",slug:"/components/inputs/nats_stream",permalink:"/docs/components/inputs/nats_stream",editUrl:"https://github.com/Jeffail/benthos/edit/master/website/docs/components/inputs/nats_stream.md",version:"current",sidebar:"docs",previous:{title:"nats",permalink:"/docs/components/inputs/nats"},next:{title:"nsq",permalink:"/docs/components/inputs/nsq"}},u=[{value:"Metadata",id:"metadata",children:[]},{value:"Fields",id:"fields",children:[{value:"<code>urls</code>",id:"urls",children:[]},{value:"<code>cluster_id</code>",id:"cluster_id",children:[]},{value:"<code>client_id</code>",id:"client_id",children:[]},{value:"<code>queue</code>",id:"queue",children:[]},{value:"<code>subject</code>",id:"subject",children:[]},{value:"<code>durable_name</code>",id:"durable_name",children:[]},{value:"<code>unsubscribe_on_close</code>",id:"unsubscribe_on_close",children:[]},{value:"<code>start_from_oldest</code>",id:"start_from_oldest",children:[]},{value:"<code>max_inflight</code>",id:"max_inflight",children:[]},{value:"<code>ack_wait</code>",id:"ack_wait",children:[]}]}],b={toc:u};function d(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"Subscribe to a NATS Stream subject. Joining a queue is optional and allows\nmultiple clients of a subject to consume using queue semantics."),Object(c.b)(o.a,{defaultValue:"common",values:[{label:"Common",value:"common"},{label:"Advanced",value:"advanced"}],mdxType:"Tabs"},Object(c.b)(i.a,{value:"common",mdxType:"TabItem"},Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"# Common config fields, showing default values\ninput:\n  nats_stream:\n    urls:\n      - nats://127.0.0.1:4222\n    cluster_id: test-cluster\n    client_id: benthos_client\n    queue: benthos_queue\n    subject: benthos_messages\n    durable_name: benthos_offset\n    unsubscribe_on_close: false\n"))),Object(c.b)(i.a,{value:"advanced",mdxType:"TabItem"},Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"# All config fields, showing default values\ninput:\n  nats_stream:\n    urls:\n      - nats://127.0.0.1:4222\n    cluster_id: test-cluster\n    client_id: benthos_client\n    queue: benthos_queue\n    subject: benthos_messages\n    durable_name: benthos_offset\n    unsubscribe_on_close: false\n    start_from_oldest: true\n    max_inflight: 1024\n    ack_wait: 30s\n")))),Object(c.b)("p",null,"Tracking and persisting offsets through a durable name is also optional and\nworks with or without a queue. If a durable name is not provided then subjects\nare consumed from the most recently published message."),Object(c.b)("p",null,"When a consumer closes its connection it unsubscribes, when all consumers of a\ndurable queue do this the offsets are deleted. In order to avoid this you can\nstop the consumers from unsubscribing by setting the field\n",Object(c.b)("inlineCode",{parentName:"p"},"unsubscribe_on_close")," to ",Object(c.b)("inlineCode",{parentName:"p"},"false"),"."),Object(c.b)("h3",{id:"metadata"},"Metadata"),Object(c.b)("p",null,"This input adds the following metadata fields to each message:"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text"}),"- nats_stream_subject\n- nats_stream_sequence\n")),Object(c.b)("p",null,"You can access these metadata fields using\n",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/configuration/interpolation#metadata"}),"function interpolation"),"."),Object(c.b)("h2",{id:"fields"},"Fields"),Object(c.b)("h3",{id:"urls"},Object(c.b)("inlineCode",{parentName:"h3"},"urls")),Object(c.b)("p",null,"A list of URLs to connect to. If an item of the list contains commas it will be expanded into multiple URLs."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"array"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},'["nats://127.0.0.1:4222"]'),"  "),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"# Examples\n\nurls:\n  - nats://127.0.0.1:4222\n\nurls:\n  - nats://username:password@127.0.0.1:4222\n")),Object(c.b)("h3",{id:"cluster_id"},Object(c.b)("inlineCode",{parentName:"h3"},"cluster_id")),Object(c.b)("p",null,"The ID of the cluster to consume from."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"string"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},'"test-cluster"'),"  "),Object(c.b)("h3",{id:"client_id"},Object(c.b)("inlineCode",{parentName:"h3"},"client_id")),Object(c.b)("p",null,"A client ID to connect as."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"string"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},'"benthos_client"'),"  "),Object(c.b)("h3",{id:"queue"},Object(c.b)("inlineCode",{parentName:"h3"},"queue")),Object(c.b)("p",null,"The queue to consume from."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"string"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},'"benthos_queue"'),"  "),Object(c.b)("h3",{id:"subject"},Object(c.b)("inlineCode",{parentName:"h3"},"subject")),Object(c.b)("p",null,"A subject to consume from."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"string"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},'"benthos_messages"'),"  "),Object(c.b)("h3",{id:"durable_name"},Object(c.b)("inlineCode",{parentName:"h3"},"durable_name")),Object(c.b)("p",null,"Preserve the state of your consumer under a durable name."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"string"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},'"benthos_offset"'),"  "),Object(c.b)("h3",{id:"unsubscribe_on_close"},Object(c.b)("inlineCode",{parentName:"h3"},"unsubscribe_on_close")),Object(c.b)("p",null,"Whether the subscription should be destroyed when this client disconnects."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"bool"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},"false"),"  "),Object(c.b)("h3",{id:"start_from_oldest"},Object(c.b)("inlineCode",{parentName:"h3"},"start_from_oldest")),Object(c.b)("p",null,"If a position is not found for a queue, determines whether to consume from the oldest available message, otherwise messages are consumed from the latest."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"bool"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},"true"),"  "),Object(c.b)("h3",{id:"max_inflight"},Object(c.b)("inlineCode",{parentName:"h3"},"max_inflight")),Object(c.b)("p",null,"The maximum number of unprocessed messages to fetch at a given time."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"number"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},"1024"),"  "),Object(c.b)("h3",{id:"ack_wait"},Object(c.b)("inlineCode",{parentName:"h3"},"ack_wait")),Object(c.b)("p",null,"An optional duration to specify at which a message that is yet to be acked will be automatically retried."),Object(c.b)("p",null,"Type: ",Object(c.b)("inlineCode",{parentName:"p"},"string"),Object(c.b)("br",{parentName:"p"}),"\n","Default: ",Object(c.b)("inlineCode",{parentName:"p"},'"30s"'),"  "))}d.isMDXComponent=!0},411:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),u=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},b=function(e){var t=u(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},p=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,c=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),b=u(n),p=a,m=b["".concat(o,".").concat(p)]||b[p]||d[p]||c;return n?r.a.createElement(m,i(i({ref:t},l),{},{components:n})):r.a.createElement(m,i({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var c=n.length,o=new Array(c);o[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var l=2;l<c;l++)o[l]=n[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},412:function(e,t,n){"use strict";function a(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(r&&(r+=" "),r+=t);return r}},413:function(e,t,n){"use strict";var a=n(0),r=n(414);t.a=function(){var e=Object(a.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},414:function(e,t,n){"use strict";var a=n(0),r=Object(a.createContext)(void 0);t.a=r},415:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(413),o=n(412),i=n(56),s=n.n(i),l=37,u=39;t.a=function(e){var t=e.lazy,n=e.block,i=e.defaultValue,b=e.values,d=e.groupId,p=e.className,m=Object(c.a)(),f=m.tabGroupChoices,O=m.setTabGroupChoices,j=Object(a.useState)(i),h=j[0],_=j[1],v=a.Children.toArray(e.children);if(null!=d){var g=f[d];null!=g&&g!==h&&b.some((function(e){return e.value===g}))&&_(g)}var y=function(e){_(e),null!=d&&O(d,e)},N=[];return r.a.createElement("div",null,r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(o.a)("tabs",{"tabs--block":n},p)},b.map((function(e){var t=e.value,n=e.label;return r.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":h===t,className:Object(o.a)("tabs__item",s.a.tabItem,{"tabs__item--active":h===t}),key:t,ref:function(e){return N.push(e)},onKeyDown:function(e){!function(e,t,n){switch(n.keyCode){case u:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case l:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(N,e.target,e)},onFocus:function(){return y(t)},onClick:function(){y(t)}},n)}))),t?Object(a.cloneElement)(v.filter((function(e){return e.props.value===h}))[0],{className:"margin-vert--md"}):r.a.createElement("div",{className:"margin-vert--md"},v.map((function(e,t){return Object(a.cloneElement)(e,{key:t,hidden:e.props.value!==h})}))))}},416:function(e,t,n){"use strict";var a=n(3),r=n(0),c=n.n(r);t.a=function(e){var t=e.children,n=e.hidden,r=e.className;return c.a.createElement("div",Object(a.a)({role:"tabpanel"},{hidden:n,className:r}),t)}}}]);