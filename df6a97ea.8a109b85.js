(window.webpackJsonp=window.webpackJsonp||[]).push([[154],{234:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return s})),a.d(t,"toc",(function(){return l})),a.d(t,"default",(function(){return i}));var r=a(3),n=a(7),c=(a(0),a(260)),o={title:"Database Search",sidebar_label:"Database Search"},s={unversionedId:"platform_concepts/data/database-search",id:"platform_concepts/data/database-search",isDocsHomePage:!1,title:"Database Search",description:"How to do elastic search for database",source:"@site/docs/platform_concepts/data/database-search.md",slug:"/platform_concepts/data/database-search",permalink:"/docs/platform_concepts/data/database-search",version:"current",sidebar_label:"Database Search",sidebar:"platform_concepts",previous:{title:"Creating Tables and Inserting Data",permalink:"/docs/platform_concepts/data/create-tables"},next:{title:"Understanding The Growth Module",permalink:"/docs/platform_concepts/growth/growth"}},l=[{value:"How to do elastic search for database",id:"how-to-do-elastic-search-for-database",children:[]},{value:"How to search Database?",id:"how-to-search-database",children:[]}],b={toc:l};function i(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(c.b)("wrapper",Object(r.a)({},b,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("h3",{id:"how-to-do-elastic-search-for-database"},"How to do elastic search for database"),Object(c.b)("h4",{id:"datastore"},"DataStore"),Object(c.b)("p",null,"The datastore is the local database that is available with each bot instance. It is stored inside MongoDB and is indexed with ElasticSearch."),Object(c.b)("p",null,"Each bot\u2019s table gets it\u2019s own index, by default. If needed, you can specify your own elasticsearch mapping to map the database as per your need."),Object(c.b)("h4",{id:"architecture"},"Architecture"),Object(c.b)("p",null,"Each table in the bot gets its own space in MongoDB and gets indexed into elasticsearch."),Object(c.b)("p",null,"You can use the UI to create the table, but in order to query through your code, you will need to know how to write elasticsearch queries"),Object(c.b)("p",null,"A good place to start would be: ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.7/getting-started.html"}),"Elastic Search Guide")),Object(c.b)("h4",{id:"datastore-ui"},"Datastore UI"),Object(c.b)("p",null,"The datastore in the UI can be accessed through Developer -> Database, herewith referred to as database section in this document"),Object(c.b)("p",null,"Datastore API\nThe datastore is available inside the app library and can be accessed with app.dataStore"),Object(c.b)("h4",{id:"datastore-methods"},"Datastore methods"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"search"),Object(c.b)("li",{parentName:"ul"},"insert"),Object(c.b)("li",{parentName:"ul"},"update"),Object(c.b)("li",{parentName:"ul"},"delete"),Object(c.b)("li",{parentName:"ul"},"find"),Object(c.b)("li",{parentName:"ul"},"aggregate"),Object(c.b)("li",{parentName:"ul"},"updateMany"),Object(c.b)("li",{parentName:"ul"},"get"),Object(c.b)("li",{parentName:"ul"},"getForm"),Object(c.b)("li",{parentName:"ul"},"search\nThe datastore search can be used to search for the record in the table")),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),"app.datastore.search({\n    table: tableName,\n    body: esQuery\n})\n")),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"tableName"),": The table name that is present in the database section"),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"esQuery"),": The elastic search query that is to be used to search for the records"),Object(c.b)("p",null,"This function is promisified and hence can be chained for success and reject cases. The chain would go into the reject block in-case of any errors. It is vital to handle this part."),Object(c.b)("h4",{id:"insert"},"insert"),Object(c.b)("p",null,"The datastore insert function can be used to add records to your table"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),"app.datastore.insert({\n        table: tableName,\n        record: recordObject\n    })\n\n")),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"tableName"),": The table name that is present in the database section"),Object(c.b)("p",null,Object(c.b)("em",{parentName:"p"},"recordObject"),": The Object containing the key-value pairs of the record. The keys are the column names and the values are the values for the columns. The keys have to match the exact column name present in the table"),Object(c.b)("h3",{id:"how-to-search-database"},"How to search Database?"),Object(c.b)("p",null,"As you can see in the screenshot below, we have a userdata table where we're storing super important and classified information of Superheros. Now, to search in this database we've two options."),Object(c.b)("p",null,Object(c.b)("img",Object(r.a)({parentName:"p"},{src:"https://cdn.yellowmessenger.com/IayOU3SuI8Q01616761692169.png",alt:"User Data DB"}))),Object(c.b)("h4",{id:"1-search-using-search-bar"},Object(c.b)("strong",{parentName:"h4"},"1. Search using search bar:")),Object(c.b)("p",null,"In the search bar you can enter your search string and results will be showed below. You can also select in which column you want to search from the ",Object(c.b)("inlineCode",{parentName:"p"},"All fields")," dropdown menu."),Object(c.b)("p",null,Object(c.b)("img",Object(r.a)({parentName:"p"},{src:"https://cdn.yellowmessenger.com/yloJuXwtyJz21616761857240.png",alt:"Search DB"}))),Object(c.b)("h4",{id:"2-search-using-query"},Object(c.b)("strong",{parentName:"h4"},"2. Search using query:")),Object(c.b)("p",null,"Go to Data > Developer tools and select table. In the ",Object(c.b)("inlineCode",{parentName:"p"},"Query")," section, you can enter your query and Output will be shown on the right."),Object(c.b)("p",null,"For example, to search which Superheros lives in the Gotham city you can write a query like this:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),'{\n    "query":{\n        "match":{\n            "city": "Gotham" // search keyword\n        }\n    }\n}\n')),Object(c.b)("p",null,Object(c.b)("img",Object(r.a)({parentName:"p"},{src:"https://cdn.yellowmessenger.com/KqGlwDEAuqhj1616761866852.png",alt:"Query DB"}))))}i.isMDXComponent=!0},260:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return d}));var r=a(0),n=a.n(r);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},c=Object.keys(e);for(r=0;r<c.length;r++)a=c[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)a=c[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var b=n.a.createContext({}),i=function(e){var t=n.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=i(e.components);return n.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},h=n.a.forwardRef((function(e,t){var a=e.components,r=e.mdxType,c=e.originalType,o=e.parentName,b=l(e,["components","mdxType","originalType","parentName"]),p=i(a),h=r,d=p["".concat(o,".").concat(h)]||p[h]||u[h]||c;return a?n.a.createElement(d,s(s({ref:t},b),{},{components:a})):n.a.createElement(d,s({ref:t},b))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var c=a.length,o=new Array(c);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var b=2;b<c;b++)o[b]=a[b];return n.a.createElement.apply(null,o)}return n.a.createElement.apply(null,a)}h.displayName="MDXCreateElement"}}]);