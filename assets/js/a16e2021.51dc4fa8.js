"use strict";(self.webpackChunkbenthos=self.webpackChunkbenthos||[]).push([[2943],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return f}});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=o.createContext({}),s=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=s(e.components);return o.createElement(p.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=a,f=d["".concat(p,".").concat(m)]||d[m]||u[m]||i;return n?o.createElement(f,r(r({ref:t},c),{},{components:n})):o.createElement(f,r({ref:t},c))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[d]="string"==typeof e?e:a,r[1]=l;for(var s=2;s<i;s++)r[s]=n[s];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},7809:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return d}});var o=n(87462),a=n(63366),i=(n(67294),n(3905)),r=["components"],l={title:"Mobile push",sidebar_label:"Mobile push"},p=void 0,s={unversionedId:"platform_concepts/channelConfiguration/mobilepush",id:"platform_concepts/channelConfiguration/mobilepush",title:"Mobile push",description:"Push notifications help in communicating important information through mobile or web apps as notifications. It could be offers, app updates, important announcements, order information, or any other information that you want your app users to notify.",source:"@site/docs/platform_concepts/channelConfiguration/mobilepush.md",sourceDirName:"platform_concepts/channelConfiguration",slug:"/platform_concepts/channelConfiguration/mobilepush",permalink:"/docs/platform_concepts/channelConfiguration/mobilepush",draft:!1,tags:[],version:"current",frontMatter:{title:"Mobile push",sidebar_label:"Mobile push"}},c={},d=[{value:"1. Configure FCM for Android push",id:"1-configure-fcm-for-android-push",level:2},{value:"Set up push notification for Android apps",id:"set-up-push-notification-for-android-apps",level:3},{value:"Prequisites",id:"prequisites",level:4},{value:"Add Firebase to your Android project",id:"add-firebase-to-your-android-project",level:3},{value:"Enable FCM and upload API key on Yellow.ai",id:"enable-fcm-and-upload-api-key-on-yellowai",level:3},{value:"Create a notification service",id:"create-a-notification-service",level:3},{value:"Code snipets",id:"code-snipets",level:3},{value:"Fetch extra data from notification when clicked",id:"fetch-extra-data-from-notification-when-clicked",level:4},{value:"Start bot with extra data and bot details",id:"start-bot-with-extra-data-and-bot-details",level:4},{value:"Handle notification for foreground app",id:"handle-notification-for-foreground-app",level:4},{value:"Example payloads",id:"example-payloads",level:3},{value:"Notification without custom action",id:"notification-without-custom-action",level:4},{value:"Notification with deep link",id:"notification-with-deep-link",level:4},{value:"Notification with bot response:",id:"notification-with-bot-response",level:4},{value:"2. Set up push notifications for iOS/Mac apps",id:"2-set-up-push-notifications-for-iosmac-apps",level:2},{value:"Sample Payloads:",id:"sample-payloads",level:3},{value:"Notification without custom action",id:"notification-without-custom-action-1",level:4},{value:"Notification with Deep-link:",id:"notification-with-deep-link-1",level:4},{value:"Notification with bot response:",id:"notification-with-bot-response-1",level:4}],u={toc:d};function m(e){var t=e.components,n=(0,a.Z)(e,r);return(0,i.kt)("wrapper",(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Push notifications help in communicating important information through mobile or web apps as notifications. It could be offers, app updates, important announcements, order information, or any other information that you want your app users to notify."),(0,i.kt)("p",null,"You can send push notifications to mobile or desktop applications using the following services:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Firebase Cloud Messaging")," (FCM):  To send push notifications to Android apps."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Apple Push Notification Service")," (APNS): To send push notifications to iOS or Mac OS apps.")),(0,i.kt)("h2",{id:"1-configure-fcm-for-android-push"},"1. Configure FCM for Android push"),(0,i.kt)("h3",{id:"set-up-push-notification-for-android-apps"},"Set up push notification for Android apps"),(0,i.kt)("p",null,"To send push notifications on Android apps, you need to have a Firebase account with the app configured."),(0,i.kt)("p",null,"For managing push notifications, you must have a  ",(0,i.kt)("a",{parentName:"p",href:"https://console.firebase.google.com/"},"Firebase account"),"."),(0,i.kt)("h4",{id:"prequisites"},"Prequisites"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create an Android project on Firebase.")),(0,i.kt)("h3",{id:"add-firebase-to-your-android-project"},"Add Firebase to your Android project"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Login to ",(0,i.kt)("a",{parentName:"li",href:"https://console.firebase.google.com/"},"Google Firebase")," with the client's account."),(0,i.kt)("li",{parentName:"ol"},"Select the project that is connected to the the mobile app.")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://i.imgur.com/wWLefrH.png",alt:null})),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"To add a new project, click ",(0,i.kt)("strong",{parentName:"p"},"Add project"),". ")),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"On the ",(0,i.kt)("em",{parentName:"li"},"Push notification")," screen, select the android app and click Configure. To add a new app, click ",(0,i.kt)("strong",{parentName:"li"},"+Add app"),".")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://i.imgur.com/YyFXXLE.png",alt:null})),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},"Navigate to ",(0,i.kt)("strong",{parentName:"li"},"Service accounts")," option from the top navigation bar"),(0,i.kt)("li",{parentName:"ol"},"Click on ",(0,i.kt)("strong",{parentName:"li"},"Generate new private key"),". A JSON file will be downloaded which contains all the credentials.")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://lh5.googleusercontent.com/rF2x0PNOdJqnkqxQyd_i3AZj8KEK4jdnFB6e-2sFGDMYdLoMgZpR_Ewpf0eoM4XWHJirHLDjCyV9LZTMSi3oMLoRxEh02XrcrWy5QQswYADaWlKTvXDyV7wkAHQH7yUZc0FocAlp7Q0KWcaKphXy7tmiyA4DBqKZAlV2TuYuucU2_PtHmcZDFTToh3rQrg",alt:null})),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"For a detailed help,  ",(0,i.kt)("a",{parentName:"p",href:"https://firebase.google.com/docs/cloud-messaging/android/client"},"see Firebase documentation"),".\n2.  To setup Firebase Cloud Messaging client app on Android,  see the ",(0,i.kt)("a",{parentName:"p",href:"https://firebase.google.com/docs/cloud-messaging/android/client"},"Firebase official documentation"),".")),(0,i.kt)("h3",{id:"enable-fcm-and-upload-api-key-on-yellowai"},"Enable FCM and upload API key on Yellow.ai"),(0,i.kt)("p",null,"To enable FCM in yellow.ai: "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Go to ",(0,i.kt)("strong",{parentName:"li"},"Channels")," > ",(0,i.kt)("strong",{parentName:"li"},"Push Notifications")," > ",(0,i.kt)("strong",{parentName:"li"},"Android (FCM)"),"."),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("strong",{parentName:"li"},"Upload")," and choose the downloaded JSON file."),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("strong",{parentName:"li"},"Add")," to upload")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://secure-res.craft.do/v2/MXpitnt98nfq77xcERfHs5nKdeJUqQ42x1Paqh34KHvmo25ikVQryimMtxX8fAdU1SBcf9ZSL7SHduNiC1QsYBiwvFXXGgrEXzBXsR66jC14o7djEPtQKjWC2ZNyUmiYiYVsjd8UCUPNBKyRSKiXH3phdZF949jPshsBcT72G3ZqPoFiVGzQbgZLDEfUZSgDZZceh38sz116SVLCrGC4YFrLucpLLcUS41YppMQCXNEwcevcZYmjwagkzDJSJJvCPRUYTmqVkmC3r4sNaL511omqxMGaViz7HZw7LLyhEZVDifig8f/Image.jpg",alt:null})),(0,i.kt)("h3",{id:"create-a-notification-service"},"Create a notification service"),(0,i.kt)("p",null,"Notification Extra Payload"),(0,i.kt)("p",null,"This is used to pass a custom object with key-value pairs while hitting the notification API for any extra data that needs to be received on the webhook along with delivery updates."),(0,i.kt)("p",null,"These extra params will be sent along with the notification in case of an on tap action template"),(0,i.kt)("p",null,"botId - The bot id for which the notification has been triggered"),(0,i.kt)("p",null,"journeySlug - The journey name which has to be triggered for bot execute flow templates."),(0,i.kt)("h3",{id:"code-snipets"},"Code snipets"),(0,i.kt)("h4",{id:"fetch-extra-data-from-notification-when-clicked"},"Fetch extra data from notification when clicked"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'HashMap < String, Object > payloadData = new HashMap < > ();\nHashMap < String, Object > botPayloadData = new HashMap < > ();\n\nBundle bundle = getIntent().getExtras();\nif (bundle != null) {\n    String tmp = "";\n    for (String key: bundle.keySet()) {\n        Object value = bundle.get(key);\n        payloadData.put(key, value);\n        tmp += key + ": " + value + "\\n\\n";\n    }\n    mTextView.setText(tmp);\n}\n')),(0,i.kt)("h4",{id:"start-bot-with-extra-data-and-bot-details"},"Start bot with extra data and bot details"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'if (payloadData.get("botId") != null) {\n    String botId = (String) payloadData.get("botId");\n    YMChat ymChat = YMChat.getInstance();\n\n    ymChat.config = new YMConfig(botId);\n    ymChat.config.version = 2;\n    ymChat.config.ymAuthenticationToken = "2gs20emoof1666164936076";\n\n    if (payloadData.get("journeySlug") != null) {\n        String journeySlug = (String) payloadData.get("journeySlug");\n        botPayloadData.put("JourneySlug", journeySlug);\n        ymChat.config.payload = botPayloadData;\n    }\n\n    try {\n        ymChat.startChatbot(this);\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n')),(0,i.kt)("h4",{id:"handle-notification-for-foreground-app"},"Handle notification for foreground app"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'import android.util.Log\nimport com.google.firebase.messaging.FirebaseMessagingService\nimport com.google.firebase.messaging.RemoteMessage\n\nclass MyFirebaseMessagingService: FirebaseMessagingService() {\n    final\n    var TAG: String = "YMLog"\n    override fun onMessageReceived(remoteMessage: RemoteMessage) {\n        Log.i(TAG + " Remote message", remoteMessage.toString())\n        Log.i(TAG + " Remote message", remoteMessage.data.toString())\n        super.onMessageReceived(remoteMessage)\n    }\n}\n')),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"For more details regarding integration, go through our ",(0,i.kt)("a",{parentName:"li",href:"https://docs.yellow.ai/docs/platform_concepts/mobile/chatbot/android"},"Android mobile SDK documentation"),"."),(0,i.kt)("li",{parentName:"ul"},"You can also refer to our ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/yellowmessenger/YmChatBot-Android-DemoApp"},"Test app with Android mobile SDK and Firebase integration")))),(0,i.kt)("h3",{id:"example-payloads"},"Example payloads"),(0,i.kt)("h4",{id:"notification-without-custom-action"},"Notification without custom action"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'{\n    "notification": {\n        "title": "Hey there",\n        "body": "Body",\n        "image": "url"\n    },\n    "token": < deviceToken >\n}\n')),(0,i.kt)("h4",{id:"notification-with-deep-link"},"Notification with deep link"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'{\n    "notification": {\n        "title": "Hey there",\n        "body": "Body",\n        "image": "url"\n    },\n    "data": {\n        "botId": < botId > ,\n        "deeplink": "url"\n    },\n    "token": < deviceToken >\n}\n')),(0,i.kt)("h4",{id:"notification-with-bot-response"},"Notification with bot response:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'{\n    "notification": {\n        "title": "Hey there",\n        "body": "Body",\n        "image": "url"\n    },\n    "data": {\n        "botId": < botId > ,\n        "journeySlug": "slug"\n    },\n    "token": < deviceToken >\n}\n')),(0,i.kt)("h2",{id:"2-set-up-push-notifications-for-iosmac-apps"},"2. Set up push notifications for iOS/Mac apps"),(0,i.kt)("p",null,"Integrating with APNs"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Using these ",(0,i.kt)("a",{parentName:"li",href:"https://help.apple.com/developer-account/?_gl=1*1ydwszb*_ga*MTE1NjEzMTkzLjE2NTc3MTEyMzA.*_ga_8VQ6F1K67R*MTY2OTcxNDEzNS44OS4wLjE2Njk3MTQxNDMuMC4wLjA.*_ga_05Y0102HN7*MTY2OTcxNDEzNS40LjAuMTY2OTcxNDE0My4wLjAuMA..#/devcdfbb56a3"},"instructions"),", create and download a private key with APNs enabled. Note the Key ID for the next step. Alternatively, use an existing private key with APNs enabled.")),(0,i.kt)("p",null,"To enable APNs in yellow.ai, follow these steps:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Go to ",(0,i.kt)("strong",{parentName:"li"},"Channels")," > ",(0,i.kt)("strong",{parentName:"li"},"Push Notifications")," > ",(0,i.kt)("strong",{parentName:"li"},"iOS  (APNs)"),"."),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("strong",{parentName:"li"},"Upload")," and choose the .p8 file that you created."),(0,i.kt)("li",{parentName:"ol"},"Enter the ",(0,i.kt)("em",{parentName:"li"},"Key ID"),", the Bundle ID and the Apple Team ID from the previous step."),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("strong",{parentName:"li"},"Add")," to upload")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://secure-res.craft.do/v2/MXpitnt98nfq77xcERfHs5nKdeJUqQ42x1Paqh34KHvmo25ikVQryimMtxX8fAdU1SBcf9ZSL7SHduNiC1QsYBiwvFXXGgrEXzBXsR66jC14o7djEPtQKjWC2ZNyUmiYiYVsjd8UCUPNBKyRSKiXH3phczPr5qEBBoRoSV3iqCoFycXWFy15mVNCUZX1Adjze6y7ZKhWDgfpAD1441wesaaVVXcax81jmqN8N5cSPaSqPm19dLwQUjSGuofoMCvsVwi5P5tha29zHoQWcocWjaZXU4E41UbPy5C3aLWBEYofj9D5Wt/Image.jpg",alt:null})),(0,i.kt)("h3",{id:"sample-payloads"},"Sample Payloads:"),(0,i.kt)("h4",{id:"notification-without-custom-action-1"},"Notification without custom action"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n "topic": {bundleId},\n "contentAvailable": true,\n "title": "hey there",\n "body": "description",\n "payload": {\n "image": "url"\n }\n}\n')),(0,i.kt)("h4",{id:"notification-with-deep-link-1"},"Notification with Deep-link:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "topic": "{bundleId}",\n  "contentAvailable": true,\n  "title": "hey there",\n  "body": "description",\n  "payload": {\n    "image": "url",\n    "botId": "{botID}",\n    "deeplink": "url"\n  }\n}\n')),(0,i.kt)("h4",{id:"notification-with-bot-response-1"},"Notification with bot response:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "topic": "{bundleId}",\n  "contentAvailable": true,\n  "title": "hey there",\n  "body": "description",\n  "payload": {\n    "botId": "{botID}",\n    "image": "url",\n    "journeySlug": "slug"\n  }\n}\n')))}m.isMDXComponent=!0}}]);