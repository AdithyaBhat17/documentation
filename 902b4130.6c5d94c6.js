(window.webpackJsonp=window.webpackJsonp||[]).push([[204],{277:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return r})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return d}));var i=n(3),o=n(7),l=(n(0),n(446)),a=["components"],c={title:"Inbox SDK for iOS",sidebar_label:"iOS"},r={unversionedId:"platform_concepts/mobile/inbox/ios",id:"platform_concepts/mobile/inbox/ios",isDocsHomePage:!1,title:"Inbox SDK for iOS",description:"SDK integration",source:"@site/docs/platform_concepts/mobile/inbox/ios.md",slug:"/platform_concepts/mobile/inbox/ios",permalink:"/docs/platform_concepts/mobile/inbox/ios",version:"current",sidebar_label:"iOS",sidebar:"platform_concepts",previous:{title:"Inbox SDK for Android",permalink:"/docs/platform_concepts/mobile/inbox/android"},next:{title:"Inbox SDK for Cordova",permalink:"/docs/platform_concepts/mobile/inbox/cordova"}},s=[{value:"SDK integration",id:"sdk-integration",children:[]},{value:"Initialization",id:"initialization",children:[]},{value:"Overview",id:"overview",children:[{value:"Overview Viewcontroller",id:"overview-viewcontroller",children:[]}]},{value:"My Chat",id:"my-chat",children:[{value:"My Chat Viewcontroller",id:"my-chat-viewcontroller",children:[]}]},{value:"Notifications",id:"notifications",children:[{value:"Background Notification",id:"background-notification",children:[]},{value:"Local Notification",id:"local-notification",children:[]},{value:"Video call Notification",id:"video-call-notification",children:[]}]},{value:"Agent Status",id:"agent-status",children:[{value:"Get All Agent Statuses",id:"get-all-agent-statuses",children:[]},{value:"Get Agent Status",id:"get-agent-status",children:[]},{value:"Set Agent Status",id:"set-agent-status",children:[]}]},{value:"Logout",id:"logout",children:[]},{value:"Informational",id:"informational",children:[{value:"Versions",id:"versions",children:[]},{value:"Permissions",id:"permissions",children:[]}]}],b={toc:s};function d(e){var t=e.components,n=Object(o.a)(e,a);return Object(l.b)("wrapper",Object(i.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("h2",{id:"sdk-integration"},"SDK integration"),Object(l.b)("p",null,"To add SDK into your project add the following pod into your pod file"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-ruby"}," pod 'YellowInbox'\n")),Object(l.b)("h2",{id:"initialization"},"Initialization"),Object(l.b)("p",null,"The SDK can be initialised by passing API_KEY, USER_ID and BOT_ID to the initialize method."),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"}," @objc public class func initialize(with \n     botId: String, \n     apiKey: String, \n     userId: String,\n     completion: ((_ isSuccess: Bool) -> Void)? = nil\n)\n")),Object(l.b)("h4",{id:"apikey"},"apiKey"),Object(l.b)("p",null,"apiKey will be provided by yellow.ai, It is clients responsibility to keep the API_KEY safe.\nThis is a mandatory parameter."),Object(l.b)("h4",{id:"userid"},"userId"),Object(l.b)("p",null,"userId will be the id registered/provided to yellow.ai by the client to authenticate their employee. This is a mandatory parameter."),Object(l.b)("h4",{id:"botid"},"botId"),Object(l.b)("p",null,"botId will be provided by yellow.ai.\nThis is a mandatory parameter."),Object(l.b)("h4",{id:"example"},"Example"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},'import YellowInbox\n \nclass ViewController: UIViewController {\n \n  override func viewDidLoad() {\n    super.viewDidLoad()\n \n    YellowInbox.initialize(with: <#"bot id"#>, \n        apiKey: <#"API key"#>, \n        userId: <#"USER_ID"#>) { success in\n            if success {  print("SDK initialized successfully") }\n            else {  print("Error while initializing the SDK")  } \n      }\n   }\n}\n')),Object(l.b)("h2",{id:"overview"},"Overview"),Object(l.b)("p",null,"Overview view is provided as a viewcontroller."),Object(l.b)("h3",{id:"overview-viewcontroller"},"Overview Viewcontroller"),Object(l.b)("p",null,"If clients want to use the Overview viewcontroller in their application, they can call the following method to get the viewcontroller object."),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"let viewController = YellowInbox.makeOverviewViewController()\n")),Object(l.b)("p",null,"client can push, present and embed this viewcontroller as they do for any other viewcontrollers."),Object(l.b)("h2",{id:"my-chat"},"My Chat"),Object(l.b)("p",null,"Chats view is provided as a viewcontroller."),Object(l.b)("h3",{id:"my-chat-viewcontroller"},"My Chat Viewcontroller"),Object(l.b)("p",null,"If clients want to use the MyChat viewcontroller in their application, they can call the following method to get the viewcontroller object."),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"let viewController = YellowInbox.makeMyChatsViewController()\n")),Object(l.b)("p",null,"client can push, present and embed this viewcontroller as they do for any other viewcontrollers."),Object(l.b)("h2",{id:"notifications"},"Notifications"),Object(l.b)("h3",{id:"background-notification"},"Background Notification"),Object(l.b)("p",null,"To receive firebase notification clients need to send Firebase device token to SDK. To do so the following method can be used."),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},'YellowInbox.setNotificationToken(<#"device token"#>)\n')),Object(l.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(l.b)("div",{parentName:"div",className:"admonition-heading"},Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",{parentName:"h5",className:"admonition-icon"},Object(l.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(l.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(l.b)("div",{parentName:"div",className:"admonition-content"},Object(l.b)("p",{parentName:"div"},"Make sure to call this function when the device token is changed."))),Object(l.b)("p",null,"Clients will receive firebase notification if the app is not running in foreground or in background, or if Ticket Create, User Message or Agent is added as collaborator actions happening on a ticket."),Object(l.b)("p",null,"Clients need not to listen to these notifications when the app is running, SDK will take care of such events."),Object(l.b)("p",null,"Clients need to call following method if they want to take user to appropriate view once user clicks on notification delivered in system tray and sent by yellow.ai"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},'let viewController = YellowInbox.makeConversationView(ticketId: <#"ticket id"#>)\n')),Object(l.b)("p",null,"client can push and present this viewcontroller as they do for any other viewcontrollers."),Object(l.b)("h3",{id:"local-notification"},"Local Notification"),Object(l.b)("p",null,"Clients will receive local notification that will be triggered by the SDK based on the events received over XMPP.\nIn case a client wants to override the normal behaviour of notification or want to update title/body, they can do so by they can do so by delegate methods."),Object(l.b)("p",null,"Clients need to do the following step."),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"YellowInbox.delegate = self\n")),Object(l.b)("p",null,"Following are the delegates methods:"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"@objc func willShowCreateTicketLocalNotification(\n    title: String?, \n    body: String?) -> YellowLocalNotification?\n \n@objc func willShowUpdateTicketLocalNotification(\n    title: String?, \n    body: String?) -> YellowLocalNotification?\n")),Object(l.b)("p",null,"Example "),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},'class ViewController: UIViewController, YellowInboxDelegate {\n    func willShowCreateTicketLocalNotification(\n        title: String?,\n        body: String?) -> YellowLocalNotification? {\n          return YellowLocalNotification(title: <#"title"#>, body: <#"body"#>)\n    }\n    \n    func willShowUpdateTicketLocalNotification(\n        title: String?,\n        body: String?) -> YellowLocalNotification? {\n          return YellowLocalNotification(title: <#"title"#>, body: <#"body"#>)\n    }\n}  \n')),Object(l.b)("p",null,"Clients will get callbacks on these methods for creating and updating tickets notification. Clients can return a YellowLocalNotification instance with a modified title and body. if client dont wont to update the content the can return nil."),Object(l.b)("h3",{id:"video-call-notification"},"Video call Notification"),Object(l.b)("p",null,"If a client is receiving a video call notification while the app is in background, Simply tapping on notification and check for the notification type in didReceive response function."),Object(l.b)("p",null,"In case the app is running and in the foreground, client need to check for notification type into will present method."),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},"Client need to set the Firebase token in case device token changes by calling")),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},'    YellowInbox.setNotificationToken("DEVICE_TOKEN")\n')),Object(l.b)("ol",{start:2},Object(l.b)("li",{parentName:"ol"},"In didReceive response function client need to check if notification type is video call. client can open received url on webview or any default webapp.")),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"let notificationType: YellowInbox.Notification? = YellowInbox.notificationType(response.notification)\nswitch notificationType {\n  case let .videoCall(url, ticketId):\n      // Use this url to open in web browser        \n  default: break;\n}\n")),Object(l.b)("p",null,"Example"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"class AppDelegate: UIResponder, UIApplicationDelegate, UNUserNotificationCenterDelegate,   MessagingDelegate { \n    func userNotificationCenter(_ center: UNUserNotificationCenter, willPresent notification: UNNotification, withCompletionHandler completionHandler: @escaping (UNNotificationPresentationOptions) -> Void) {\n        let notificationType: YellowInbox.Notification? = YellowInbox.notificationType(notification)\n            if case .videoCall(let url, let ticketId) = notificationType {\n                SceneDelegate.shared?.showVideoCallAlert(for: url, ticketId: ticketId)          \n            }\n        completionHandler([.alert, .badge, .sound])\n    }\n \n    func userNotificationCenter(_ center: UNUserNotificationCenter didReceive response: UNNotificationResponse, withCompletionHandler completionHandler: @escaping () -> Void) {\n        let notificationType: YellowInbox.Notification? = YellowInbox.notificationType(response.notification)\n            if case .videoCall(let url, let ticketId) = notificationType {\n                SceneDelegate.shared?.showVideoCallAlert(for: url, ticketId: ticketId)          \n            }\n        completionHandler()\n    }\n}\n")),Object(l.b)("p",null,"A call declined from notification can be joined from the Chat view by tapping on the call icon"),Object(l.b)("h2",{id:"agent-status"},"Agent Status"),Object(l.b)("h3",{id:"get-all-agent-statuses"},"Get All Agent Statuses"),Object(l.b)("p",null,"To get all possible statuses of logged in User against the bot id (Used for initialising the SDK), client can call the following method. This can be used to show all the possible status when Agent want to change the status."),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"@objc public class func getAllAgentStatus(\n    onSuccess: @escaping ([YellowAgentStatus]?) -> Void, \n    onFailure: @escaping (Error) -> Void)\n")),Object(l.b)("h3",{id:"get-agent-status"},"Get Agent Status"),Object(l.b)("p",null,"To get availability status of logged in User against the bot id (Used for initialising the SDK), client can call the following method"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"@objc public class func getAgentStatus(\n    onSuccess: @escaping (YellowAgentStatus?) -> Void, \n    onFailure: @escaping (Error) -> Void)\n")),Object(l.b)("p",null,"Example"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"YellowInbox.getAgentStatus(\n    onSuccess: { agentStatus in let status = agentStatus }, \n    onFailure: { error in print(error) }\n)\n")),Object(l.b)("h3",{id:"set-agent-status"},"Set Agent Status"),Object(l.b)("p",null,"To set the status of logged in user against the bot id (Used for initialising the SDK), the client can call the following method and observe on it. Client need to pass the YellowAgentStatus object received from making ",Object(l.b)("inlineCode",{parentName:"p"},"YellowInbox.getAllAgentStatus()")," call"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"@objc public class func setAgentStatus(\n    _ status: YellowAgentStatus, \n    onSuccess: @escaping (YellowAgentStatus) -> Void, \n    onFailure: @escaping (Error) -> Void)\n")),Object(l.b)("p",null,"Example"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},'YellowInbox.setAgentStatus(\n    status,\n    onSuccess: { _ in print("Status changed") },\n    onFailure: { error in print(error) }\n)\n')),Object(l.b)("h2",{id:"logout"},"Logout"),Object(l.b)("p",null,"By calling logout, all the services and notifications will be terminated. You can call this function when user logs out of the app"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},"@objc public class func logout(completion: @escaping ((Bool, Error?) -> Void))\n")),Object(l.b)("p",null,"Example"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-swift"},'YellowInbox.logout { isSuccess, error  in\n    if isSuccess { print("Logout successfully") }\n    else if let error = error { print(error) }\n}\n')),Object(l.b)("h2",{id:"informational"},"Informational"),Object(l.b)("h3",{id:"versions"},"Versions"),Object(l.b)("p",null,"YellowInbox SDK requires iOS 13.0 and above"),Object(l.b)("h3",{id:"permissions"},"Permissions"),Object(l.b)("p",null,"YellowInbox SDK usage following permissions."),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-xml"},"<key>NSPhotoLibraryUsageDescription</key>\n<string>Your description</string>\n<key>NSCameraUsageDescription</key>\n<string>Your description</string>\n")),Object(l.b)("p",null,"Clients need to add this permissions to their app\u2019s Info.plist."))}d.isMDXComponent=!0},446:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var i=n(0),o=n.n(i);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},l=Object.keys(e);for(i=0;i<l.length;i++)n=l[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)n=l[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=o.a.createContext({}),b=function(e){var t=o.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},d=function(e){var t=b(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},u=o.a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,l=e.originalType,a=e.parentName,s=r(e,["components","mdxType","originalType","parentName"]),d=b(n),u=i,f=d["".concat(a,".").concat(u)]||d[u]||p[u]||l;return n?o.a.createElement(f,c(c({ref:t},s),{},{components:n})):o.a.createElement(f,c({ref:t},s))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var l=n.length,a=new Array(l);a[0]=u;var c={};for(var r in t)hasOwnProperty.call(t,r)&&(c[r]=t[r]);c.originalType=e,c.mdxType="string"==typeof e?e:i,a[1]=c;for(var s=2;s<l;s++)a[s]=n[s];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);