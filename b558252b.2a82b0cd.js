(window.webpackJsonp=window.webpackJsonp||[]).push([[244],{321:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return b})),n.d(t,"default",(function(){return u}));var a=n(3),r=n(7),o=(n(0),n(411)),c=n(415),i=n(416),s={title:"unarchive",type:"processor",status:"stable",categories:["Parsing"]},l={unversionedId:"components/processors/unarchive",id:"components/processors/unarchive",isDocsHomePage:!1,title:"unarchive",description:"\x3c!--",source:"@site/docs/components/processors/unarchive.md",slug:"/components/processors/unarchive",permalink:"/docs/components/processors/unarchive",editUrl:"https://github.com/Jeffail/benthos/edit/master/website/docs/components/processors/unarchive.md",version:"current",sidebar:"docs",previous:{title:"try",permalink:"/docs/components/processors/try"},next:{title:"while",permalink:"/docs/components/processors/while"}},b=[{value:"Fields",id:"fields",children:[{value:"<code>format</code>",id:"format",children:[]},{value:"<code>parts</code>",id:"parts",children:[]}]},{value:"Formats",id:"formats",children:[{value:"<code>tar</code>",id:"tar",children:[]},{value:"<code>zip</code>",id:"zip",children:[]},{value:"<code>binary</code>",id:"binary",children:[]},{value:"<code>lines</code>",id:"lines",children:[]},{value:"<code>json_documents</code>",id:"json_documents",children:[]},{value:"<code>json_array</code>",id:"json_array",children:[]},{value:"<code>json_map</code>",id:"json_map",children:[]}]}],p={toc:b};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Unarchives messages according to the selected archive ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"#formats"}),"format")," into\nmultiple messages within a ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/configuration/batching"}),"batch"),"."),Object(o.b)(c.a,{defaultValue:"common",values:[{label:"Common",value:"common"},{label:"Advanced",value:"advanced"}],mdxType:"Tabs"},Object(o.b)(i.a,{value:"common",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"# Common config fields, showing default values\nunarchive:\n  format: binary\n"))),Object(o.b)(i.a,{value:"advanced",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"# All config fields, showing default values\nunarchive:\n  format: binary\n  parts: []\n")))),Object(o.b)("p",null,"When a message is unarchived the new messages replace the original message in\nthe batch. Messages that are selected but fail to unarchive (invalid format)\nwill remain unchanged in the message batch but will be flagged as having failed,\nallowing you to ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/configuration/error_handling"}),"error handle them"),"."),Object(o.b)("p",null,"For the unarchive formats that contain file information (tar, zip), a metadata\nfield is added to each message called ",Object(o.b)("inlineCode",{parentName:"p"},"archive_filename")," with the\nextracted filename."),Object(o.b)("h2",{id:"fields"},"Fields"),Object(o.b)("h3",{id:"format"},Object(o.b)("inlineCode",{parentName:"h3"},"format")),Object(o.b)("p",null,"The unarchive ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"#formats"}),"format")," to use."),Object(o.b)("p",null,"Type: ",Object(o.b)("inlineCode",{parentName:"p"},"string"),Object(o.b)("br",{parentName:"p"}),"\n","Default: ",Object(o.b)("inlineCode",{parentName:"p"},'"binary"'),Object(o.b)("br",{parentName:"p"}),"\n","Options: ",Object(o.b)("inlineCode",{parentName:"p"},"tar"),", ",Object(o.b)("inlineCode",{parentName:"p"},"zip"),", ",Object(o.b)("inlineCode",{parentName:"p"},"binary"),", ",Object(o.b)("inlineCode",{parentName:"p"},"lines"),", ",Object(o.b)("inlineCode",{parentName:"p"},"json_documents"),", ",Object(o.b)("inlineCode",{parentName:"p"},"json_array"),", ",Object(o.b)("inlineCode",{parentName:"p"},"json_map"),"."),Object(o.b)("h3",{id:"parts"},Object(o.b)("inlineCode",{parentName:"h3"},"parts")),Object(o.b)("p",null,"An optional array of message indexes of a batch that the processor should apply to.\nIf left empty all messages are processed. This field is only applicable when\nbatching messages ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/configuration/batching"}),"at the input level"),"."),Object(o.b)("p",null,"Indexes can be negative, and if so the part will be selected from the end\ncounting backwards starting from -1."),Object(o.b)("p",null,"Type: ",Object(o.b)("inlineCode",{parentName:"p"},"array"),Object(o.b)("br",{parentName:"p"}),"\n","Default: ",Object(o.b)("inlineCode",{parentName:"p"},"[]"),"  "),Object(o.b)("h2",{id:"formats"},"Formats"),Object(o.b)("h3",{id:"tar"},Object(o.b)("inlineCode",{parentName:"h3"},"tar")),Object(o.b)("p",null,"Extract messages from a unix standard tape archive."),Object(o.b)("h3",{id:"zip"},Object(o.b)("inlineCode",{parentName:"h3"},"zip")),Object(o.b)("p",null,"Extract messages from a zip file."),Object(o.b)("h3",{id:"binary"},Object(o.b)("inlineCode",{parentName:"h3"},"binary")),Object(o.b)("p",null,"Extract messages from a binary blob format consisting of:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Four bytes containing number of messages in the batch (in big endian)"),Object(o.b)("li",{parentName:"ul"},"For each message part:",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"Four bytes containing the length of the message (in big endian)"),Object(o.b)("li",{parentName:"ul"},"The content of message")))),Object(o.b)("h3",{id:"lines"},Object(o.b)("inlineCode",{parentName:"h3"},"lines")),Object(o.b)("p",null,"Extract the lines of a message each into their own message."),Object(o.b)("h3",{id:"json_documents"},Object(o.b)("inlineCode",{parentName:"h3"},"json_documents")),Object(o.b)("p",null,"Attempt to parse a message as a stream of concatenated JSON documents. Each\nparsed document is expanded into a new message."),Object(o.b)("h3",{id:"json_array"},Object(o.b)("inlineCode",{parentName:"h3"},"json_array")),Object(o.b)("p",null,"Attempt to parse a message as a JSON array, and extract each element into its\nown message."),Object(o.b)("h3",{id:"json_map"},Object(o.b)("inlineCode",{parentName:"h3"},"json_map")),Object(o.b)("p",null,"Attempt to parse the message as a JSON map and for each element of the map\nexpands its contents into a new message. A metadata field is added to each\nmessage called ",Object(o.b)("inlineCode",{parentName:"p"},"archive_key")," with the relevant key from the top-level\nmap."))}u.isMDXComponent=!0},411:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),b=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=b(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=b(n),d=a,m=p["".concat(c,".").concat(d)]||p[d]||u[d]||o;return n?r.a.createElement(m,i(i({ref:t},l),{},{components:n})):r.a.createElement(m,i({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,c=new Array(o);c[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,c[1]=i;for(var l=2;l<o;l++)c[l]=n[l];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},412:function(e,t,n){"use strict";function a(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(r&&(r+=" "),r+=t);return r}},413:function(e,t,n){"use strict";var a=n(0),r=n(414);t.a=function(){var e=Object(a.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},414:function(e,t,n){"use strict";var a=n(0),r=Object(a.createContext)(void 0);t.a=r},415:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(413),c=n(412),i=n(56),s=n.n(i),l=37,b=39;t.a=function(e){var t=e.lazy,n=e.block,i=e.defaultValue,p=e.values,u=e.groupId,d=e.className,m=Object(o.a)(),f=m.tabGroupChoices,h=m.setTabGroupChoices,O=Object(a.useState)(i),j=O[0],v=O[1],g=a.Children.toArray(e.children);if(null!=u){var y=f[u];null!=y&&y!==j&&p.some((function(e){return e.value===y}))&&v(y)}var N=function(e){v(e),null!=u&&h(u,e)},w=[];return r.a.createElement("div",null,r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(c.a)("tabs",{"tabs--block":n},d)},p.map((function(e){var t=e.value,n=e.label;return r.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":j===t,className:Object(c.a)("tabs__item",s.a.tabItem,{"tabs__item--active":j===t}),key:t,ref:function(e){return w.push(e)},onKeyDown:function(e){!function(e,t,n){switch(n.keyCode){case b:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case l:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(w,e.target,e)},onFocus:function(){return N(t)},onClick:function(){N(t)}},n)}))),t?Object(a.cloneElement)(g.filter((function(e){return e.props.value===j}))[0],{className:"margin-vert--md"}):r.a.createElement("div",{className:"margin-vert--md"},g.map((function(e,t){return Object(a.cloneElement)(e,{key:t,hidden:e.props.value!==j})}))))}},416:function(e,t,n){"use strict";var a=n(3),r=n(0),o=n.n(r);t.a=function(e){var t=e.children,n=e.hidden,r=e.className;return o.a.createElement("div",Object(a.a)({role:"tabpanel"},{hidden:n,className:r}),t)}}}]);